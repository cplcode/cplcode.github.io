<!DOCTYPE html><html lang="en"><head><title>Gauss-Seidel.cpl</title><meta name="description" content="CPL listing"><base href="https://CPLcode.net/Documentation/"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>pre{font-family:monospace,monospace;font-size:1em;} .comment{color:HotPink;} a:link,a:visited{color:MediumBlue}</style></head><body translate="no"><pre>
<span class=comment>! Gauss-Seidel iteration for Poisson's equation</span>
<span class=comment>! =============================================</span>

<a href="cpl.html#USE">USE</a> <a href="graphics.html#gnuplot">gnuplot</a>   <span class=comment>! prepare for plotting</span>
<a href="cpl.html#ARRAY">ARRAY</a>(0..20,0..40) <a href="cpl.html#OF">OF</a> <a href="cpl.html#REAL">REAL</a> var,rhs   <span class=comment>! declare and allocate ARRAY variables</span>

var<a href="cpl.html#Assignment">=</a>0; rhs<a href="cpl.html#Assignment">=</a>0
<a href="cpl.html#DO">DO</a> var(i,<a href="cpl.html#HI">HI</a>)<a href="cpl.html#Assignment">=</a>1 <a href="cpl.html#FOR">FOR</a> <a href="cpl.html#ALL">ALL</a> i   <span class=comment>! assign some boundary conditions</span>

<a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#FOR">FOR</a> 100 <a href="cpl.html#TIMES">TIMES</a>   <span class=comment>! main iteration loop</span>
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a><a href="cpl.html#LO">LO</a>+1 <a href="cpl.html#TO">TO</a> <a href="cpl.html#HI">HI</a>-1 <a href="cpl.html#AND">AND</a> j<a href="cpl.html#Assignment">=</a><a href="cpl.html#LO">LO</a>+1 <a href="cpl.html#TO">TO</a> <a href="cpl.html#HI">HI</a>-1
    var(i,j)<a href="cpl.html#Assignment">=</a>[var(i,j+1)+var(i,j-1)+var(i+1,j)+var(i-1,j) + rhs(i,j)]/4
  <a href="cpl.html#LOOP">REPEAT</a> <a href="cpl.html#LOOP">LOOP</a>   <span class=comment>! these three lines are the core iteration</span>
<a href="cpl.html#LOOP">REPEAT</a> <a href="cpl.html#LOOP">LOOP</a>

<a href="graphics.html#SPLOT">SPLOT</a> var
<a href="cpl.html#READ">READ</a> <span class=comment>! keep plot displayed until Enter is pressed</span>

<span class=comment>!(
  A single LOOP instruction can loop over several indices. Indices are
  implicitly declared. Various LOOP and DO forms are available.
  Round, square and curly brackets can be used like in mathematics.
!)</span>
</pre></body></html>
