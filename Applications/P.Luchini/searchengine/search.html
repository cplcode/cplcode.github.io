<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>P.Luchini/searchengine/search.cpl</title><meta name="description" content="CPL listing"><base href="https://CPLcode.net/Documentation/"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>pre{font-family:monospace,monospace;font-size:1em;} .comment{color:HotPink;} a:link,a:visited{color:MediumBlue}</style>
<script type="application/ld+json">{
"@context":"http://schema.org",
"@type":"SoftwareSourceCode",
"name":"P.Luchini/searchengine/search.cpl",
"programmingLanguage":{
"@type":"ComputerLanguage",
"name":"CPL",
"disambiguatingDescription":"Compiled Programming Language Created by Paolo Luchini",
"url":"https://cplcode.net"}
}</script></head>
<body translate="no"><pre>
<a href="cpl.html#C-interface">#include</a> &lt;sys/mman.h&gt;

<a href="cpl.html#CHAR">CHAR</a> alpha(0..255)<a href="cpl.html#Assignment">=</a>0
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>i <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>"0" <a href="cpl.html#TO">TO</a> "9"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>i-"A"+"a" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>"A" <a href="cpl.html#TO">TO</a> "Z"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>i <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>"a" <a href="cpl.html#TO">TO</a> "z"
alpha("?")<a href="cpl.html#Assignment">=</a>"?"
alpha("&lowast;")<a href="cpl.html#Assignment">=</a>"&lowast;"
alpha("+")<a href="cpl.html#Assignment">=</a>"+"
<span class=comment>! alpha(".")="."</span>
alpha("'")<a href="cpl.html#Assignment">=</a>"'"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"a" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>192 <a href="cpl.html#TO">TO</a> 197
alpha(199)<a href="cpl.html#Assignment">=</a>"c"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"e" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>200 <a href="cpl.html#TO">TO</a> 203
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"i" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>204 <a href="cpl.html#TO">TO</a> 207
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"o" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>210 <a href="cpl.html#TO">TO</a> 214
alpha(216)<a href="cpl.html#Assignment">=</a>"o"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"u" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>217 <a href="cpl.html#TO">TO</a> 220
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"a" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>224 <a href="cpl.html#TO">TO</a> 229
alpha(231)<a href="cpl.html#Assignment">=</a>"c"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"e" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>232 <a href="cpl.html#TO">TO</a> 235
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"i" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>236 <a href="cpl.html#TO">TO</a> 239
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"o" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>242 <a href="cpl.html#TO">TO</a> 246
alpha(248)<a href="cpl.html#Assignment">=</a>"o"
<a href="cpl.html#DO">DO</a> alpha(i)<a href="cpl.html#Assignment">=</a>"u" <a href="cpl.html#FOR">FOR</a> i<a href="cpl.html#Assignment">=</a>249 <a href="cpl.html#TO">TO</a> 252

indexsize<a href="cpl.html#Assignment">=</a>0x10000000
<span class=comment>! POINTER TO STORED ARRAY(0..indexsize-1) OF INTEGER idx</span>
<span class=comment>! index=MMAP(idx)</span>
idx<a href="cpl.html#Assignment">=</a>open(""database".idx",O_RDONLY)
<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> <a href="cpl.html#ARRAY">ARRAY</a>(0..indexsize-1) <a href="cpl.html#OF">OF</a> <a href="cpl.html#INTEGER">INTEGER</a> index
index<a href="cpl.html#Assignment">=</a>mmap64(<a href="cpl.html#POINTER">NULL</a>,indexsize,PROT_READ,MAP_SHARED,idx,0)
root<a href="cpl.html#Deferred-assignment">==</a>2
replim<a href="cpl.html#Assignment">=</a>index(1)

WS_type<a href="cpl.html#Assignment">=</a><a href="cpl.html#STRUCTURE">STRUCTURE</a>()
Match_WS<a href="cpl.html#Assignment">=</a><a href="cpl.html#STRUCTURE">STRUCTURE</a>(WS_type; <a href="cpl.html#INTEGER">INTEGER</a> loc,nw)
Or_WS<a href="cpl.html#Assignment">=</a><a href="cpl.html#STRUCTURE">STRUCTURE</a>(WS_type; DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type W1, W2; <a href="cpl.html#INTEGER">INTEGER</a> n1,n2)
<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> Or_WS WS) <a href="cpl.html#FOLLOWS">FOLLOWS</a>
And_WS<a href="cpl.html#Assignment">=</a><a href="cpl.html#STRUCTURE">STRUCTURE</a>(WS_type; DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type W1, W2; <a href="cpl.html#INTEGER">INTEGER</a> n1,n2)
<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> And_WS WS) <a href="cpl.html#FOLLOWS">FOLLOWS</a>
AndNot_WS<a href="cpl.html#Assignment">=</a><a href="cpl.html#STRUCTURE">STRUCTURE</a>(WS_type; DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type W1, W2; <a href="cpl.html#INTEGER">INTEGER</a> n1,n2)
<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> AndNot_WS WS) <a href="cpl.html#FOLLOWS">FOLLOWS</a>

<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> Match_WS WS) <a href="cpl.html#WITH">WITH</a> WS
  <a href="cpl.html#IF">IF</a> nw&gt;replim <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> WS; RETURN INT_MAX-1
  <a href="cpl.html#IF">IF</a> nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> WS; RETURN INT_MAX
  <a href="cpl.html#INC">INC</a> loc; <a href="cpl.html#DEC">DEC</a> nw
  <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>index(loc)
<a href="cpl.html#END">END</a> Next

<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> And_WS WS) <a href="cpl.html#WITH">WITH</a> WS
  <a href="cpl.html#DO">DO</a>
    <a href="cpl.html#IF">IF</a> n1&lt;<a href="cpl.html#Assignment">=</a>n2 <a href="cpl.html#IF">THEN</a> n1<a href="cpl.html#Assignment">=</a>Next(W1) <a href="cpl.html#ELSE">ELSE</a> n2<a href="cpl.html#Assignment">=</a>Next(W2)
  <a href="cpl.html#UNTIL">UNTIL</a> n1<a href="cpl.html#Assignment">=</a>n2 <a href="cpl.html#OR">OR</a> n1<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#OR">OR</a> n2<a href="cpl.html#Assignment">=</a>INT_MAX-1
  <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a><a href="cpl.html#IF">IF</a> n1<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#IF">THEN</a> n2 <a href="cpl.html#ELSE">ELSE</a> n1
  <a href="cpl.html#IF">IF</a> <a href="cpl.html#RESULT">RESULT</a>&gt;<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> WS
<a href="cpl.html#END">END</a> Next

<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> Or_WS WS) <a href="cpl.html#WITH">WITH</a> WS
  oldn1<a href="cpl.html#Assignment">=</a>n1
  <a href="cpl.html#IF">IF</a> n1&lt;<a href="cpl.html#Assignment">=</a>n2 <a href="cpl.html#IF">THEN</a> n1<a href="cpl.html#Assignment">=</a>Next(W1)
  <a href="cpl.html#IF">IF</a> n2&lt;<a href="cpl.html#Assignment">=</a>oldn1 <a href="cpl.html#IF">THEN</a> n2<a href="cpl.html#Assignment">=</a>Next(W2)
  <a href="cpl.html#IF">IF</a> n1<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> n2&lt;INT_MAX-1: n2<a href="cpl.html#Assignment">=</a>Next(W2)
  <a href="cpl.html#IF">IF</a> n2<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> n1&lt;INT_MAX-1: n1<a href="cpl.html#Assignment">=</a>Next(W1)
  <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a><a href="cpl.html#MIN">MIN</a>(n1,n2)
  <a href="cpl.html#IF">IF</a> <a href="cpl.html#RESULT">RESULT</a>&gt;<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> WS
<a href="cpl.html#END">END</a> Next

<a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Next(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> AndNot_WS WS) <a href="cpl.html#WITH">WITH</a> WS
  <a href="cpl.html#DO">DO</a>
    n1<a href="cpl.html#Assignment">=</a>Next(W1)
    <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> n1&gt;n2; n2<a href="cpl.html#Assignment">=</a>Next(W2); <a href="cpl.html#LOOP">REPEAT</a>
  <a href="cpl.html#UNTIL">UNTIL</a> n1#n2 <a href="cpl.html#OR">OR</a> n1&gt;<a href="cpl.html#Assignment">=</a>INT_MAX-1
  <a href="cpl.html#IF">IF</a> n1&gt;<a href="cpl.html#Assignment">=</a>INT_MAX-1 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> WS
  <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>n1
<a href="cpl.html#END">END</a> Next

DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type <a href="cpl.html#FUNCTION">FUNCTION</a> join(DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type w1,w2)
  <a href="cpl.html#BOOLEAN">BOOLEAN</a> killed<a href="cpl.html#Assignment">=</a>FALSE
  <a href="cpl.html#IF">IF</a> w1 IS Match_WS <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#IF">IF</a> w1.nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
      <a href="cpl.html#NEW">FREE</a> w1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w2; killed<a href="cpl.html#Assignment">=</a>TRUE
    <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#IF">IF</a> w1.nw&gt;replim <a href="cpl.html#IF">THEN</a>
      <a href="cpl.html#IF">IF</a> w2 IS Match_WS <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> w2 <a href="cpl.html#ELSE">ELSE</a>
        <a href="cpl.html#DO">DO</a> n<a href="cpl.html#Assignment">=</a>Next(w2) <a href="cpl.html#UNTIL">UNTIL</a> n&gt;<a href="cpl.html#Assignment">=</a>INT_MAX-1
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w1; killed<a href="cpl.html#Assignment">=</a>TRUE  
    <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>    
  <a href="cpl.html#IF">IF</a> <a href="cpl.html#NOT">NOT</a> killed <a href="cpl.html#IF">THEN</a> <a href="cpl.html#IF">IF</a> w2 IS Match_WS <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#IF">IF</a> w2.nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
      <a href="cpl.html#NEW">FREE</a> w2; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w1; killed<a href="cpl.html#Assignment">=</a>TRUE
    <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#IF">IF</a> w2.nw&gt;replim <a href="cpl.html#IF">THEN</a>
      <a href="cpl.html#IF">IF</a> w1 IS Match_WS <a href="cpl.html#IF">THEN</a> <a href="cpl.html#NEW">FREE</a> w1 <a href="cpl.html#ELSE">ELSE</a>
        <a href="cpl.html#DO">DO</a> n<a href="cpl.html#Assignment">=</a>Next(w1) <a href="cpl.html#UNTIL">UNTIL</a> n&gt;<a href="cpl.html#Assignment">=</a>INT_MAX-1
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w2; killed<a href="cpl.html#Assignment">=</a>TRUE
    <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
  <a href="cpl.html#IF">IF</a> <a href="cpl.html#NOT">NOT</a> killed <a href="cpl.html#IF">THEN</a>
    WSq<a href="cpl.html#Assignment">=</a><a href="cpl.html#NEW">NEW</a> Or_WS
    WSq.n1<a href="cpl.html#Assignment">=</a>0; WSq.n2<a href="cpl.html#Assignment">=</a>0
    WSq.W1<a href="cpl.html#Assignment">=</a>w1
    WSq.W2<a href="cpl.html#Assignment">=</a>w2
    <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>WSq
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
<a href="cpl.html#END">END</a> join

DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type <a href="cpl.html#FUNCTION">FUNCTION</a> condjoin(DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type w1,w2)
  <a href="cpl.html#IF">IF</a> w2 IS Match_WS <a href="cpl.html#AND">AND</a> (w2.nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> w2.nw&gt;replim) <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#NEW">FREE</a> w2; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w1
  <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#IF">IF</a> w1 IS Match_WS <a href="cpl.html#AND">AND</a> (w1.nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> w1.nw&gt;replim) <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#NEW">FREE</a> w1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w2
  <a href="cpl.html#ELSE">ELSE</a>
    WSq<a href="cpl.html#Assignment">=</a><a href="cpl.html#NEW">NEW</a> Or_WS
    WSq.n1<a href="cpl.html#Assignment">=</a>0; WSq.n2<a href="cpl.html#Assignment">=</a>0
    WSq.W1<a href="cpl.html#Assignment">=</a>w1
    WSq.W2<a href="cpl.html#Assignment">=</a>w2
    <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>WSq
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
<a href="cpl.html#END">END</a> condjoin

DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type <a href="cpl.html#FUNCTION">FUNCTION</a> chain(DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type w1,w2)
  <a href="cpl.html#BOOLEAN">BOOLEAN</a> killed<a href="cpl.html#Assignment">=</a>FALSE
  <a href="cpl.html#IF">IF</a> w1 IS Match_WS <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#IF">IF</a> w1.nw&gt;replim <a href="cpl.html#IF">THEN</a>
      <a href="cpl.html#NEW">FREE</a> w1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w2; killed<a href="cpl.html#Assignment">=</a>TRUE
    <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#IF">IF</a> w2 IS Match_WS <a href="cpl.html#IF">THEN</a>
      <a href="cpl.html#IF">IF</a> w1.nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#NEW">FREE</a> w2; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w1; killed<a href="cpl.html#Assignment">=</a>TRUE
      <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#IF">IF</a> w2.nw<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#NEW">FREE</a> w1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w2; killed<a href="cpl.html#Assignment">=</a>TRUE
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
    <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
  <a href="cpl.html#IF">IF</a> <a href="cpl.html#NOT">NOT</a> killed <a href="cpl.html#IF">THEN</a> <a href="cpl.html#IF">IF</a> w2 IS Match_WS <a href="cpl.html#AND">AND</a> w2.nw&gt;replim <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#NEW">FREE</a> w2; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>w1
  <a href="cpl.html#ELSE">ELSE</a>
    WSq<a href="cpl.html#Assignment">=</a><a href="cpl.html#NEW">NEW</a> And_WS
    WSq.n1<a href="cpl.html#Assignment">=</a>0; WSq.n2<a href="cpl.html#Assignment">=</a>0
    WSq.W1<a href="cpl.html#Assignment">=</a>w1
    WSq.W2<a href="cpl.html#Assignment">=</a>w2
    <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>WSq
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
<a href="cpl.html#END">END</a> chain

DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type <a href="cpl.html#FUNCTION">FUNCTION</a> Pattern(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING start<a href="cpl.html#REAL-operator">^</a>) <a href="cpl.html#FOLLOWS">FOLLOWS</a>
<a href="cpl.html#CHAR">CHAR</a> wordbuf(100),foundwords(10000)
<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#INTO">INTO</a> foundwords fws,wordstart
<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING PatternString

DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type <a href="cpl.html#FUNCTION">FUNCTION</a> Match(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING start<a href="cpl.html#REAL-operator">^</a>; <a href="cpl.html#INTEGER">INTEGER</a> <a href="cpl.html#VARIABLE">VARIABLE</a> loc,sub,nerr
    <a href="cpl.html#VARIABLE">VARIABLE</a> <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#INTO">INTO</a> wordbuf fw; <a href="cpl.html#BOOLEAN">BOOLEAN</a> <a href="cpl.html#VARIABLE">VARIABLE</a> printfws)
  <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING word<a href="cpl.html#Assignment">=</a>start,word1
  <a href="cpl.html#IF">IF</a> word(0)<a href="cpl.html#Assignment">=</a>"(" <a href="cpl.html#IF">THEN</a>
    <a href="cpl.html#INC">INC</a> word; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>Pattern(word)
    start<a href="cpl.html#Assignment">=</a>word+1; <a href="cpl.html#EXIT">EXIT</a> Match
  <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> word(0)<a href="cpl.html#Assignment">=</a>"+": <a href="cpl.html#INC">INC</a> nerr; printfws<a href="cpl.html#Assignment">=</a><a href="cpl.html#BOOLEAN">NO</a>; <a href="cpl.html#INC">INC</a> word
  <a href="cpl.html#ARRAY">ARRAY</a>(0..3) <a href="cpl.html#OF">OF</a> <a href="cpl.html#CHAR">CHAR</a> locchr
  <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc)
  WS<a href="cpl.html#Assignment">=</a><a href="cpl.html#NEW">NEW</a> Match_WS
  WS.nw<a href="cpl.html#Assignment">=</a>0
  <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>WS
  <a href="cpl.html#IF">IF</a> nerr<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> <a href="cpl.html#NOT">NOT</a> printfws <a href="cpl.html#IF">THEN</a> <a href="cpl.html#EXIT">EXIT</a> Match
  <a href="cpl.html#IF">IF</a> expired <a href="cpl.html#OR">OR</a> (loc<a href="cpl.html#Assignment">=</a>root <a href="cpl.html#AND">AND</a> (alpha(word(1))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> alpha(word(2))<a href="cpl.html#Assignment">=</a>0)) <a href="cpl.html#IF">THEN</a>
    WS.nw<a href="cpl.html#Assignment">=</a>INT_MAX-1
  <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#LOOP">LOOP</a> match
    <a href="cpl.html#CHAR">CHAR</a> w<a href="cpl.html#Assignment">=</a>alpha(word(0))
    <a href="cpl.html#IF">IF</a> sub&gt;locchr.<a href="cpl.html#HI">HI</a> <a href="cpl.html#OR">OR</a> sub&gt;0 <a href="cpl.html#AND">AND</a> locchr(sub)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
      loc<a href="cpl.html#Assignment">=</a>index(loc+1); <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc); sub<a href="cpl.html#Assignment">=</a>0
    <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
    <a href="cpl.html#CASE">CASE</a> w <a href="cpl.html#OF">OF</a>
    "?": <a href="cpl.html#IF">IF</a> <a href="cpl.html#NOT">NOT</a> (sub&gt;0 <a href="cpl.html#OR">OR</a> [locchr(0)#0 <a href="cpl.html#AND">AND</a> index(loc+2) <a href="cpl.html#Bitwise">BITAND</a> 0xff<a href="cpl.html#Assignment">=</a>0] <a href="cpl.html#AND">AND</a> alpha(word(1))#0) <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> locchr(0)<a href="cpl.html#Assignment">=</a>0
          word1<a href="cpl.html#Assignment">=</a>word+1
          fw(0)<a href="cpl.html#Assignment">=</a>locchr(0)
          <a href="cpl.html#IF">IF</a> locchr(1)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> locchr(1)<a href="cpl.html#Assignment">=</a>alpha(word1(0)) <a href="cpl.html#OR">OR</a> nerr&gt;0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,1,nerr,fw+1,<a href="cpl.html#BOOLEAN">NO</a>))
          loc<a href="cpl.html#Assignment">=</a>loc+2; <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc)
        <a href="cpl.html#LOOP">REPEAT</a>
        <a href="cpl.html#EXIT">EXIT</a> match
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      fw(0)<a href="cpl.html#Assignment">=</a>locchr(sub); <a href="cpl.html#INC">INC</a> fw
    "&lowast;": <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> (sub&gt;0 <a href="cpl.html#OR">OR</a> [locchr(0)#0 <a href="cpl.html#AND">AND</a> index(loc+2) <a href="cpl.html#Bitwise">BITAND</a> 0xff<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> alpha(word(1))#0]) <a href="cpl.html#AND">AND</a>
        alpha(word(1))#locchr(sub)
        fw(0)<a href="cpl.html#Assignment">=</a>locchr(sub); <a href="cpl.html#INC">INC</a> fw
        <a href="cpl.html#INC">INC</a> sub; <a href="cpl.html#IF">IF</a> sub&gt;locchr.<a href="cpl.html#HI">HI</a> <a href="cpl.html#OR">OR</a> sub&gt;0 <a href="cpl.html#AND">AND</a> locchr(sub)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
          loc<a href="cpl.html#Assignment">=</a>index(loc+1); <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc); sub<a href="cpl.html#Assignment">=</a>0
        <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#LOOP">REPEAT</a>
      <a href="cpl.html#IF">IF</a> sub<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        saveloc<a href="cpl.html#Assignment">=</a>loc
        <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> locchr(0)#0
          fw(0)<a href="cpl.html#Assignment">=</a>locchr(0)
          word1<a href="cpl.html#Assignment">=</a>word; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,1,nerr,fw+1,<a href="cpl.html#BOOLEAN">NO</a>))
          loc<a href="cpl.html#Assignment">=</a>loc+2; <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc)
        <a href="cpl.html#LOOP">REPEAT</a>
        loc<a href="cpl.html#Assignment">=</a>saveloc; <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc)
      <a href="cpl.html#ELSE">ELSE</a> word1<a href="cpl.html#Assignment">=</a>word; fw(0)<a href="cpl.html#Assignment">=</a>locchr(sub); <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,sub+1,nerr,fw+1,<a href="cpl.html#BOOLEAN">NO</a>))
      <a href="cpl.html#DEC">DEC</a> sub
    <a href="cpl.html#ELSE">ELSE</a>
      <a href="cpl.html#IF">IF</a> nerr&gt;0 <a href="cpl.html#AND">AND</a> w#0 <a href="cpl.html#AND">AND</a> w#alpha(word(1)) <span class=comment>![ AND (locchr(sub)=0 OR locchr(sub)=alpha(word(1)) OR nerr&gt;1) !]</span> <a href="cpl.html#IF">THEN</a> word1<a href="cpl.html#Assignment">=</a>word+1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,sub,nerr-1,fw,printfws))
      <a href="cpl.html#IF">IF</a> sub<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> locchr(0)&lt;<a href="cpl.html#Assignment">=</a>w
          <a href="cpl.html#IF">IF</a> nerr&gt;0 <a href="cpl.html#AND">AND</a> locchr(0)#0 <a href="cpl.html#IF">THEN</a>
            fw(0)<a href="cpl.html#Assignment">=</a>locchr(0)
            <a href="cpl.html#IF">IF</a> locchr(1)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> locchr(1)<a href="cpl.html#Assignment">=</a>w <a href="cpl.html#OR">OR</a> nerr&gt;1 <a href="cpl.html#IF">THEN</a> word1<a href="cpl.html#Assignment">=</a>word; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,1,nerr-1,fw+1,printfws))
            <a href="cpl.html#IF">IF</a> w#0 <a href="cpl.html#AND">AND</a> (locchr(1)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> locchr(1)<a href="cpl.html#Assignment">=</a>alpha(word(1)) <a href="cpl.html#OR">OR</a> nerr&gt;1) <a href="cpl.html#IF">THEN</a> word1<a href="cpl.html#Assignment">=</a>word+1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,1,nerr-1,fw+1,printfws))
          <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
          loc<a href="cpl.html#Assignment">=</a>loc+2; <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr<a href="cpl.html#Assignment">=</a>index(loc)
        <a href="cpl.html#LOOP">REPEAT</a>
        <a href="cpl.html#IF">IF</a> nerr&gt;0 <a href="cpl.html#AND">AND</a> locchr(0)#0 <a href="cpl.html#IF">THEN</a>
          <a href="cpl.html#INTEGER">INTEGER</a> loc1<a href="cpl.html#Assignment">=</a>loc+2; <a href="cpl.html#TYPE">TYPEOF</a>(locchr) locchr1; <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr1<a href="cpl.html#Assignment">=</a>index(loc1)
          <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> locchr1(0)#0
            fw(0)<a href="cpl.html#Assignment">=</a>locchr1(0)
            <a href="cpl.html#IF">IF</a> locchr(1)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> locchr(1)<a href="cpl.html#Assignment">=</a>w <a href="cpl.html#OR">OR</a> nerr&gt;1 <a href="cpl.html#IF">THEN</a> word1<a href="cpl.html#Assignment">=</a>word; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc1,1,nerr-1,fw+1,printfws))
            <a href="cpl.html#IF">IF</a> w#0 <a href="cpl.html#AND">AND</a> (locchr(1)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> locchr(1)<a href="cpl.html#Assignment">=</a>alpha(word(1)) <a href="cpl.html#OR">OR</a> nerr&gt;1) <a href="cpl.html#IF">THEN</a> word1<a href="cpl.html#Assignment">=</a>word+1; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc1,1,nerr-1,fw+1,printfws))
            loc1<a href="cpl.html#Assignment">=</a>loc1+2; <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr1<a href="cpl.html#Assignment">=</a>index(loc1)
          <a href="cpl.html#LOOP">REPEAT</a>
        <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#IF">IF</a> nerr&gt;0 <a href="cpl.html#AND">AND</a> locchr(sub)#0 <a href="cpl.html#AND">AND</a> (locchr(sub+1)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> locchr(sub+1)<a href="cpl.html#Assignment">=</a>w <a href="cpl.html#OR">OR</a> nerr&gt;1) <a href="cpl.html#IF">THEN</a>
        fw(0)<a href="cpl.html#Assignment">=</a>locchr(sub)
        word1<a href="cpl.html#Assignment">=</a>word; <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>condjoin(<a href="cpl.html#RESULT">RESULT</a>,Match(word1,loc,sub+1,nerr-1,fw+1,printfws))
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#IF">IF</a> locchr(sub)#w <a href="cpl.html#IF">THEN</a> <a href="cpl.html#DEC">DEC</a> nerr
      <a href="cpl.html#IF">IF</a> nerr&lt;0 <a href="cpl.html#OR">OR</a> locchr(sub)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> w<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#IF">IF</a> locchr(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> w<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> <a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr #0 <a href="cpl.html#IF">THEN</a>
          <a href="cpl.html#IF">IF</a> nerr<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
            <a href="cpl.html#IF">IF</a> printfws <a href="cpl.html#IF">THEN</a>
              <a href="cpl.html#IF">IF</a> fws&gt;wordstart+1000 <a href="cpl.html#OR">OR</a> fws&gt;fws.<a href="cpl.html#HI">HI</a>-100 <a href="cpl.html#IF">THEN</a>
                printfws<a href="cpl.html#Assignment">=</a><a href="cpl.html#BOOLEAN">NO</a>
                <a href="cpl.html#IF">IF</a> fws(-1)#"." <a href="cpl.html#IF">THEN</a> fws(0..<a href="cpl.html#HI">HI</a>)<a href="cpl.html#Assignment">=</a>" ..."
              <a href="cpl.html#ELSE">ELSE</a>
                <span class=comment>!              POINTER TO CSTRING sw=start-1</span>
                <span class=comment>!              LOOP WHILE alpha(sw(0))#0 AND sw&gt;=PatternString: DEC sw</span>
                <span class=comment>!              fw(0)=0; fws(0..HI)=' &lt;A HREF="?q=' PatternString(0..sw-PatternString) wordbuf PatternString(word-PatternString..1024) '"&gt;' wordbuf '&lt;/A&gt;(' (BINARY INTEGER AT locchr) RSHIFTED 8 ')'</span>
                <span class=comment>! nota: richiede conversione di "" in &amp;quot</span>
                fw(0)<a href="cpl.html#Assignment">=</a>0; fws(0..<a href="cpl.html#HI">HI</a>)<a href="cpl.html#Assignment">=</a>' &lt;A HREF="?q=' wordbuf '"&gt;' wordbuf '&lt;/A&gt;(' (<a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr) <a href="cpl.html#Bitwise">RSHIFTED</a> 8 ')'
              <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
              <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> fws(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> fws&gt;fws.<a href="cpl.html#HI">HI</a>-5: <a href="cpl.html#INC">INC</a> fws; <a href="cpl.html#LOOP">REPEAT</a>
            <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
          <a href="cpl.html#ELSE">ELSE</a>
            WS1<a href="cpl.html#Assignment">=</a><a href="cpl.html#NEW">NEW</a> Match_WS
            WS1.nw<a href="cpl.html#Assignment">=</a>(<a href="cpl.html#BINARY">BINARY</a> <a href="cpl.html#INTEGER">INTEGER</a> AT locchr) <a href="cpl.html#Bitwise">RSHIFTED</a> 8
            <a href="cpl.html#IF">IF</a> WS1.nw<a href="cpl.html#Assignment">=</a>1 <a href="cpl.html#IF">THEN</a> WS1.loc<a href="cpl.html#Assignment">=</a>loc <a href="cpl.html#ELSE">ELSE</a> WS1.loc<a href="cpl.html#Assignment">=</a>index(loc+1)-1
            <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>join(WS1,<a href="cpl.html#RESULT">RESULT</a>)
          <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
        <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
        <a href="cpl.html#EXIT">EXIT</a> match
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      fw(0)<a href="cpl.html#Assignment">=</a>locchr(sub); <a href="cpl.html#INC">INC</a> fw
    <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
    <a href="cpl.html#INC">INC</a> word
    <a href="cpl.html#INC">INC</a> sub
  <a href="cpl.html#LOOP">REPEAT</a> match
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> alpha(word(0))#0: <a href="cpl.html#INC">INC</a> word
  start<a href="cpl.html#Assignment">=</a>word
<a href="cpl.html#END">END</a> Match

<a href="cpl.html#INLINE">INLINE</a> <a href="cpl.html#FUNCTION">SUBROUTINE</a> skipfw(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING cur<a href="cpl.html#REAL-operator">^</a>)
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> cur(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>"(" <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>")" <a href="cpl.html#OR">OR</a> alpha(cur(0))#0: <a href="cpl.html#INC">INC</a> cur
<a href="cpl.html#END">END</a> skipfw

DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type <a href="cpl.html#FUNCTION">FUNCTION</a> Pattern(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING start<a href="cpl.html#REAL-operator">^</a>)
  <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING cur<a href="cpl.html#Assignment">=</a>start
  skipfw(cur)
  <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>EMPTY WS_type
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> cur(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>")"
    wordstart<a href="cpl.html#Assignment">=</a>fws
    DYNAMIC <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> WS_type ARESULT<a href="cpl.html#Assignment">=</a>Match(cur,root,0,1,0,<a href="cpl.html#BOOLEAN">YES</a>)
    skipfw(cur)
    <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> cur(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>")" <a href="cpl.html#OR">OR</a> strncmp(cur,Or,<a href="cpl.html#TYPE">SIZEOF</a>(Or))<a href="cpl.html#Assignment">=</a>0
      <a href="cpl.html#IF">IF</a> strncmp(cur,And,<a href="cpl.html#TYPE">SIZEOF</a>(And))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> cur,<a href="cpl.html#TYPE">SIZEOF</a>(And); skipfw(cur)
      <a href="cpl.html#IF">IF</a> strncmp(cur,Not,<a href="cpl.html#TYPE">SIZEOF</a>(Not))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#INC">INC</a> cur,<a href="cpl.html#TYPE">SIZEOF</a>(Not); skipfw(cur)
        <a href="cpl.html#IF">IF</a> cur(0)<a href="cpl.html#Assignment">=</a>'"' <a href="cpl.html#IF">THEN</a>
          <a href="cpl.html#DO">DO</a> <a href="cpl.html#INC">INC</a> cur <a href="cpl.html#UNTIL">UNTIL</a> cur(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>'"'
          <a href="cpl.html#IF">IF</a> cur(0)#0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> cur
        <a href="cpl.html#ELSE">ELSE</a>
          <a href="cpl.html#TYPE">TYPEOF</a>(cur) cur1<a href="cpl.html#Assignment">=</a>cur
          <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> cur1(0)#0 <a href="cpl.html#AND">AND</a> alpha(cur1(0))<a href="cpl.html#Assignment">=</a>cur1(0): <a href="cpl.html#INC">INC</a> cur1
          <a href="cpl.html#IF">IF</a> alpha(cur1(0))#0 <a href="cpl.html#IF">THEN</a>
            cur<a href="cpl.html#Assignment">=</a>cur1; <a href="cpl.html#DO">DO</a> <a href="cpl.html#INC">INC</a> cur <a href="cpl.html#UNTIL">UNTIL</a> alpha(cur(0))<a href="cpl.html#Assignment">=</a>0
          <a href="cpl.html#ELSE">ELSE</a>
            WS<a href="cpl.html#Assignment">=</a><a href="cpl.html#NEW">NEW</a> AndNot_WS
            WS.n1<a href="cpl.html#Assignment">=</a>0; WS.n2<a href="cpl.html#Assignment">=</a>0
            WS.W1<a href="cpl.html#Assignment">=</a>ARESULT
            WS.W2<a href="cpl.html#Assignment">=</a>Match(cur,root,0,1,0,<a href="cpl.html#BOOLEAN">NO</a>)
            ARESULT<a href="cpl.html#Assignment">=</a>WS
          <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
        <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#ELSE">ELSE</a> wordstart<a href="cpl.html#Assignment">=</a>fws; ARESULT<a href="cpl.html#Assignment">=</a>chain(ARESULT,Match(cur,root,0,1,0,<a href="cpl.html#BOOLEAN">YES</a>))
      skipfw(cur)
    <a href="cpl.html#LOOP">REPEAT</a>
    <a href="cpl.html#IF">IF</a> <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>EMPTY WS_type <a href="cpl.html#IF">THEN</a> <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>ARESULT <a href="cpl.html#ELSE">ELSE</a> <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>join(<a href="cpl.html#RESULT">RESULT</a>,ARESULT)
    <a href="cpl.html#IF">IF</a> strncmp(cur,Or,<a href="cpl.html#TYPE">SIZEOF</a>(Or))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> cur,<a href="cpl.html#TYPE">SIZEOF</a>(Or); skipfw(cur)
  <a href="cpl.html#LOOP">REPEAT</a>
  start<a href="cpl.html#Assignment">=</a>cur
<a href="cpl.html#END">END</a> Pattern

<a href="cpl.html#INLINE">INLINE</a> <a href="cpl.html#FUNCTION">SUBROUTINE</a> skipfwq(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING cur<a href="cpl.html#REAL-operator">^</a>)
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> cur(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>"(" <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>")" <a href="cpl.html#OR">OR</a> cur(0)<a href="cpl.html#Assignment">=</a>'"' <a href="cpl.html#OR">OR</a> alpha(cur(0))#0: <a href="cpl.html#INC">INC</a> cur
<a href="cpl.html#END">END</a> skipfwq

<a href="cpl.html#BOOLEAN">BOOLEAN</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Wmatch(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING <a href="cpl.html#VARIABLE">VARIABLE</a> s,p; <a href="cpl.html#INTEGER">INTEGER</a> basenerr)
  <a href="cpl.html#CHAR">CHAR</a> stop<a href="cpl.html#Assignment">=</a>0
  <a href="cpl.html#IF">IF</a> p(0)<a href="cpl.html#Assignment">=</a>'"' <a href="cpl.html#IF">THEN</a> stop<a href="cpl.html#Assignment">=</a>'"'; <a href="cpl.html#INC">INC</a> p
  <a href="cpl.html#INTEGER">INTEGER</a> nerr<a href="cpl.html#Assignment">=</a>basenerr
  <a href="cpl.html#LOOP">LOOP</a>
    <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> p(0)<a href="cpl.html#Assignment">=</a>"+": <a href="cpl.html#INC">INC</a> nerr; <a href="cpl.html#INC">INC</a> p
    <a href="cpl.html#CASE">CASE</a> p(0) <a href="cpl.html#OF">OF</a>
    "?":
    "&lowast;": <a href="cpl.html#INC">INC</a> p; <a href="cpl.html#IF">IF</a> alpha(p(0))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> RETURN TRUE
      <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> alpha(s(0))#0
        <a href="cpl.html#IF">IF</a> alpha(s(0))<a href="cpl.html#Assignment">=</a>alpha(p(0)) <a href="cpl.html#AND">AND</a> Wmatch(s,p,nerr) <a href="cpl.html#IF">THEN</a> RETURN TRUE
        <a href="cpl.html#INC">INC</a> s
      <a href="cpl.html#LOOP">REPEAT</a>
      RETURN FALSE         
    <a href="cpl.html#ELSE">ELSE</a>
      <a href="cpl.html#IF">IF</a> nerr&gt;0 <a href="cpl.html#AND">AND</a> [Wmatch(s+1,p,nerr-1) <a href="cpl.html#OR">OR</a> Wmatch(s,p+1,nerr-1)] <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> alpha(s(0))<a href="cpl.html#Assignment">=</a>0: <a href="cpl.html#INC">INC</a> s
        <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> alpha(p(0))<a href="cpl.html#Assignment">=</a>0: <a href="cpl.html#INC">INC</a> p
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      <a href="cpl.html#IF">IF</a> [alpha(p(0))<a href="cpl.html#Assignment">=</a>stop <a href="cpl.html#OR">OR</a> p(0)<a href="cpl.html#Assignment">=</a>stop] <a href="cpl.html#AND">AND</a> alpha(s(0))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> RETURN TRUE
      <a href="cpl.html#IF">IF</a> p(0)#s(0) <a href="cpl.html#AND">AND</a>
      <a href="cpl.html#NOT">NOT</a> {[alpha(p(0))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> alpha(p(0))<a href="cpl.html#Assignment">=</a>p(0)] <a href="cpl.html#AND">AND</a> alpha(p(0))<a href="cpl.html#Assignment">=</a>alpha(s(0))} <a href="cpl.html#IF">THEN</a> <a href="cpl.html#DEC">DEC</a> nerr
      <a href="cpl.html#IF">IF</a> nerr&lt;0 <a href="cpl.html#IF">THEN</a> RETURN FALSE
      <a href="cpl.html#IF">IF</a> alpha(p(0))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> alpha(s(0))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a>
        skipfwq(p)
        <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> s(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> alpha(s(0))#0: <a href="cpl.html#INC">INC</a> s
        nerr<a href="cpl.html#Assignment">=</a>basenerr
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
    <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
    <a href="cpl.html#INC">INC</a> p
    <a href="cpl.html#INC">INC</a> s
  <a href="cpl.html#LOOP">REPEAT</a>
<a href="cpl.html#END">END</a> Wmatch

<a href="cpl.html#FUNCTION">SUBROUTINE</a> toend(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING cur<a href="cpl.html#REAL-operator">^</a>)
  <a href="cpl.html#INTEGER">INTEGER</a> count<a href="cpl.html#Assignment">=</a>0; <a href="cpl.html#BOOLEAN">BOOLEAN</a> quot<a href="cpl.html#Assignment">=</a>FALSE
  <a href="cpl.html#DO">DO</a>
    <a href="cpl.html#CASE">CASE</a> cur(0) <a href="cpl.html#OF">OF</a>
    "(": <a href="cpl.html#INC">INC</a> count
    ")": <a href="cpl.html#DEC">DEC</a> count
    '"': quot<a href="cpl.html#Assignment">=</a><a href="cpl.html#NOT">NOT</a> quot
    <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
    <a href="cpl.html#INC">INC</a> cur
  <a href="cpl.html#UNTIL">UNTIL</a> alpha(cur(0))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> count<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#AND">AND</a> <a href="cpl.html#NOT">NOT</a> quot
<a href="cpl.html#END">END</a> toend

<a href="cpl.html#BOOLEAN">BOOLEAN</a> <a href="cpl.html#FUNCTION">FUNCTION</a> Pmatch(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING <a href="cpl.html#VARIABLE">VARIABLE</a> start, pat)
  skipfwq(pat)
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> pat(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> pat(0)<a href="cpl.html#Assignment">=</a>")"
    <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>TRUE
    <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> pat(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> pat(0)<a href="cpl.html#Assignment">=</a>")" <a href="cpl.html#OR">OR</a> strncmp(pat,Or,<a href="cpl.html#TYPE">SIZEOF</a>(Or))<a href="cpl.html#Assignment">=</a>0
      <a href="cpl.html#IF">IF</a> strncmp(pat,And,<a href="cpl.html#TYPE">SIZEOF</a>(And))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> pat,<a href="cpl.html#TYPE">SIZEOF</a>(And); skipfwq(pat)
      <a href="cpl.html#IF">IF</a> <a href="cpl.html#RESULT">RESULT</a> <a href="cpl.html#IF">THEN</a>
        <a href="cpl.html#BOOLEAN">BOOLEAN</a> neg<a href="cpl.html#Assignment">=</a>strncmp(pat,Not,<a href="cpl.html#TYPE">SIZEOF</a>(Not))<a href="cpl.html#Assignment">=</a>0
        <a href="cpl.html#IF">IF</a> neg <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> pat,<a href="cpl.html#TYPE">SIZEOF</a>(Not); skipfwq(pat)
        <a href="cpl.html#IF">IF</a> pat(0)<a href="cpl.html#Assignment">=</a>"(" <a href="cpl.html#IF">THEN</a> <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>Pmatch(start,pat+1) <a href="cpl.html#ELSE">ELSE</a>
          <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING s<a href="cpl.html#Assignment">=</a>start
          <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> s(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> alpha(s(0))#0: <a href="cpl.html#INC">INC</a> s
          <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>FALSE
          <a href="cpl.html#LOOP">LOOP</a> w <a href="cpl.html#UNTIL">UNTIL</a> s(0)<a href="cpl.html#Assignment">=</a>0
            <a href="cpl.html#IF">IF</a> Wmatch(s,pat,0) <a href="cpl.html#IF">THEN</a> <a href="cpl.html#RESULT">RESULT</a><a href="cpl.html#Assignment">=</a>TRUE; <a href="cpl.html#EXIT">EXIT</a> w
            <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> alpha(s(0))#0: <a href="cpl.html#INC">INC</a> s
            <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#UNTIL">UNTIL</a> s(0)<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#OR">OR</a> alpha(s(0))#0: <a href="cpl.html#INC">INC</a> s
          <a href="cpl.html#LOOP">REPEAT</a> w
        <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
        <a href="cpl.html#RESULT">RESULT</a> <a href="cpl.html#Assignment">=</a> <a href="cpl.html#Assignment">~</a> XOR neg
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
      toend(pat)
      skipfwq(pat)
    <a href="cpl.html#LOOP">REPEAT</a>
    <a href="cpl.html#IF">IF</a> <a href="cpl.html#RESULT">RESULT</a> <a href="cpl.html#IF">THEN</a> <a href="cpl.html#EXIT">EXIT</a> Pmatch
    <a href="cpl.html#IF">IF</a> strncmp(pat,Or,<a href="cpl.html#TYPE">SIZEOF</a>(Or))<a href="cpl.html#Assignment">=</a>0 <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> pat,<a href="cpl.html#TYPE">SIZEOF</a>(Or); skipfwq(pat)
  <a href="cpl.html#LOOP">REPEAT</a>
<a href="cpl.html#END">END</a> Pmatch

<a href="cpl.html#FUNCTION">SUBROUTINE</a> htmlwr(<a href="cpl.html#VARIABLE">VARIABLE</a> <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING s; <a href="cpl.html#BOOLEAN">BOOLEAN</a> unimarc)
  here<a href="cpl.html#Deferred-assignment">==</a>stdout
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> s(0)#0
    <a href="cpl.html#CASE">CASE</a> s(0) <a href="cpl.html#OF">OF</a>
    "|": <a href="cpl.html#IF">IF</a> unimarc <a href="cpl.html#IF">THEN</a> putc("|",here) <a href="cpl.html#ELSE">ELSE</a>
        <a href="cpl.html#INC">INC</a> s
        <a href="cpl.html#CASE">CASE</a> s(0) <a href="cpl.html#OF">OF</a>
        "f": putc("/",here)
        "e": putc(":",here)
        "g": putc(":",here)
        "x": putc("-",here)
        "b": putc(" ",here)
        "d": putc(",",here)
        "c": putc(";",here)
        "v": putc(";",here)
        <a href="cpl.html#ELSE">ELSE</a>
          putc(" ",here)
        <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
      <a href="cpl.html#END">END</a> <a href="cpl.html#IF">IF</a>
    \n: fputs("&lt;BR&gt;",here)
    '"': fputs("&amp;quot;",here)
    "&lt;": <a href="cpl.html#IF">IF</a> s(1)<a href="cpl.html#Assignment">=</a>"&lt;" <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> s <a href="cpl.html#ELSE">ELSE</a> fputs("&amp;lt;",here)
    "&gt;": <a href="cpl.html#IF">IF</a> s(1)<a href="cpl.html#Assignment">=</a>"&gt;" <a href="cpl.html#IF">THEN</a> <a href="cpl.html#INC">INC</a> s <a href="cpl.html#ELSE">ELSE</a> fputs("&amp;gt;",here)
    "&amp;": fputs("&amp;amp;",here)
    <a href="cpl.html#ELSE">ELSE</a>
      putc(s(0),here)
    <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
    <a href="cpl.html#INC">INC</a> s
  <a href="cpl.html#LOOP">REPEAT</a>
<a href="cpl.html#END">END</a> htmlwr

<a href="cpl.html#FUNCTION">SUBROUTINE</a> uri2asc(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING <a href="cpl.html#VARIABLE">VARIABLE</a> s)
  <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING t<a href="cpl.html#Assignment">=</a>s
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> s(0)#0
    <a href="cpl.html#CASE">CASE</a> s(0) <a href="cpl.html#OF">OF</a>
    "%": <a href="cpl.html#INC">INC</a> s
      t(0)<a href="cpl.html#Assignment">=</a>(<a href="cpl.html#IF">IF</a> s(0)-"0"&lt;<a href="cpl.html#Assignment">=</a>9 <a href="cpl.html#IF">THEN</a> s(0)-"0" <a href="cpl.html#ELSE">ELSE</a> s(0)-"A"+10)<a href="cpl.html#Bitwise">LSHIFTED</a> 4
      <a href="cpl.html#INC">INC</a> s
      t(0)<a href="cpl.html#Assignment">=</a><a href="cpl.html#Assignment">~</a><a href="cpl.html#Bitwise">BITOR</a> (<a href="cpl.html#IF">IF</a> s(0)-"0"&lt;<a href="cpl.html#Assignment">=</a>9 <a href="cpl.html#IF">THEN</a> s(0)-"0" <a href="cpl.html#ELSE">ELSE</a> s(0)-"A"+10)
    "+": t(0)<a href="cpl.html#Assignment">=</a>" "
    <a href="cpl.html#ELSE">ELSE</a> t(0)<a href="cpl.html#Assignment">=</a>s(0)
  <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
  <a href="cpl.html#INC">INC</a> s; <a href="cpl.html#INC">INC</a> t
<a href="cpl.html#LOOP">REPEAT</a>
t(0)<a href="cpl.html#Assignment">=</a>0
<a href="cpl.html#END">END</a> uri2asc

<a href="cpl.html#FUNCTION">SUBROUTINE</a> asc2uri(<a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> CSTRING <a href="cpl.html#VARIABLE">VARIABLE</a> s)
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#WHILE">WHILE</a> s(0)#0
    <a href="cpl.html#CASE">CASE</a> s(0) <a href="cpl.html#OF">OF</a>
    "%": <a href="cpl.html#WRITE">WRITE</a> "%25" ./.
    "+": <a href="cpl.html#WRITE">WRITE</a> "%2B" ./.
    "&amp;": <a href="cpl.html#WRITE">WRITE</a> "%26" ./.
    " ": putchar("+")
    <a href="cpl.html#ELSE">ELSE</a> putchar(s(0))
  <a href="cpl.html#END">END</a> <a href="cpl.html#CASE">CASE</a>
  <a href="cpl.html#INC">INC</a> s
<a href="cpl.html#LOOP">REPEAT</a>
<a href="cpl.html#END">END</a> asc2uri
</pre></body></html>
