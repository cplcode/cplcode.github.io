<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>FluidMechanics/SpectralDNS/convolutions.cpl</title><meta name="description" content="CPL listing"><base href="https://CPLcode.net/Documentation/"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/singlecol.css"><style> .comment{color:HotPink;} a:link,a:visited{color:MediumBlue;text-decoration:none} a:hover,a:active{text-decoration:underline}</style>
<script type="application/ld+json">{
"@context":"http://schema.org",
"@type":"SoftwareSourceCode",
"name":"FluidMechanics/SpectralDNS/convolutions.cpl",
"programmingLanguage":{
"@type":"ComputerLanguage",
"name":"CPL",
"disambiguatingDescription":"Compiler and Programming Language Conceived by Paolo Luchini",
"url":"https://cplcode.net"}
}</script></head>
<body translate="no"><pre>
VELOCITY=<a href="cpl.html#STRUCTURE">STRUCTURE</a>(<a href="complex.html#Top">COMPLEX</a> u,v,w)
<a href="cpl.html#ARRAY">ARRAY</a>(0..nx,-nz..nz,-1..ny+1) <a href="cpl.html#OF">OF</a> VELOCITY V=0
MOMFLUX=<a href="cpl.html#STRUCTURE">STRUCTURE</a>(<a href="complex.html#Top">COMPLEX</a> uu,uv,vv,vw,ww,uw)
MOMFLUX VV(0..nx,-nz..nz,-2..2)=0
<a href="cpl.html#INTEGER">INTEGER</a> nxd=3&lowast;nx <a href="cpl.html#DIV">DIV</a> 2 - 1; <a href="cpl.html#DO">DO</a> <a href="cpl.html#Builtin">INC</a> nxd <a href="cpl.html#UNTIL">UNTIL</a> FFTfit(nxd)
<a href="cpl.html#INTEGER">INTEGER</a> nzd=3&lowast;nz - 1; <a href="cpl.html#DO">DO</a> <a href="cpl.html#Builtin">INC</a> nzd <a href="cpl.html#UNTIL">UNTIL</a> FFTfit(nzd)
<a href="cpl.html#ARRAY">ARRAY</a>(0..nxd-1,0..nzd-1) <a href="cpl.html#OF">OF</a> VELOCITY Vd=0
<a href="cpl.html#ARRAY">ARRAY</a>(0..nxd-1,0..nzd-1) <a href="cpl.html#OF">OF</a> MOMFLUX VVd=0

maxtimelevels=1
RHSTYPE=<a href="cpl.html#ARRAY">ARRAY</a>(0..nx,-nz..nz) <a href="cpl.html#OF">OF</a> <a href="cpl.html#STRUCTURE">STRUCTURE</a>(<a href="complex.html#Top">COMPLEX</a> eta,D2v)
<a href="cpl.html#ARRAY">ARRAY</a>(-2..0) <a href="cpl.html#OF">OF</a> <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> RHSTYPE newrhs
<a href="cpl.html#DO">DO</a> newrhs(i) = <a href="cpl.html#NEW">NEW</a> RHSTYPE <a href="cpl.html#FOR">FOR</a> <a href="cpl.html#ALL">ALL</a> i
<a href="cpl.html#ARRAY">ARRAY</a>(maxtimelevels,1..ny-1) <a href="cpl.html#OF">OF</a> RHSTYPE oldrhs=0

<a href="cpl.html#FUNCTION">SUBROUTINE</a> convolutions(<a href="cpl.html#ARRAY">ARRAY</a>(&lowast;,&lowast;) <a href="cpl.html#OF">OF</a> VELOCITY Vplane; <a href="cpl.html#POINTER">POINTER</a> <a href="cpl.html#TO">TO</a> <a href="cpl.html#ARRAY">ARRAY</a>(&lowast;,&lowast;) <a href="cpl.html#OF">OF</a> MOMFLUX VVplane)
  Vd=0; <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#FOR">FOR</a> ix=0 <a href="cpl.html#TO">TO</a> nx
    <a href="cpl.html#DO">DO</a> Vd(ix,iz)=Vplane(ix,iz) <a href="cpl.html#FOR">FOR</a> iz=0 <a href="cpl.html#TO">TO</a> nz
    <a href="cpl.html#DO">DO</a> Vd(ix,nzd+iz)=Vplane(ix,iz) <a href="cpl.html#FOR">FOR</a> iz=-nz <a href="cpl.html#TO">TO</a> -1
    <a href="cpl.html#WITH">WITH</a> Vd(ix,&lowast;): IFT(u); IFT(v); IFT(w)
  <a href="cpl.html#LOOP">REPEAT</a> <a href="cpl.html#LOOP">LOOP</a>  
  <a href="cpl.html#DO">DO</a> <a href="cpl.html#WITH">WITH</a> Vd(&lowast;,iz): RFT(u); RFT(v); RFT(w); <a href="cpl.html#FOR">FOR</a> <a href="cpl.html#ALL">ALL</a> iz
  <a href="cpl.html#DO">DO</a> <a href="cpl.html#WITH">WITH</a> Vd(ix,iz), VVd(ix,iz)
    uu.<a href="cpl.html#REAL">REAL</a>=u.<a href="cpl.html#REAL">REAL</a>&lowast;u.<a href="cpl.html#REAL">REAL</a>; uu.<a href="complex.html#Top">IMAG</a>=u.<a href="complex.html#Top">IMAG</a>&lowast;u.<a href="complex.html#Top">IMAG</a> 
    uv.<a href="cpl.html#REAL">REAL</a>=u.<a href="cpl.html#REAL">REAL</a>&lowast;v.<a href="cpl.html#REAL">REAL</a>; uv.<a href="complex.html#Top">IMAG</a>=u.<a href="complex.html#Top">IMAG</a>&lowast;v.<a href="complex.html#Top">IMAG</a> 
    vv.<a href="cpl.html#REAL">REAL</a>=v.<a href="cpl.html#REAL">REAL</a>&lowast;v.<a href="cpl.html#REAL">REAL</a>; vv.<a href="complex.html#Top">IMAG</a>=v.<a href="complex.html#Top">IMAG</a>&lowast;v.<a href="complex.html#Top">IMAG</a> 
    vw.<a href="cpl.html#REAL">REAL</a>=v.<a href="cpl.html#REAL">REAL</a>&lowast;w.<a href="cpl.html#REAL">REAL</a>; vw.<a href="complex.html#Top">IMAG</a>=v.<a href="complex.html#Top">IMAG</a>&lowast;w.<a href="complex.html#Top">IMAG</a> 
    ww.<a href="cpl.html#REAL">REAL</a>=w.<a href="cpl.html#REAL">REAL</a>&lowast;w.<a href="cpl.html#REAL">REAL</a>; ww.<a href="complex.html#Top">IMAG</a>=w.<a href="complex.html#Top">IMAG</a>&lowast;w.<a href="complex.html#Top">IMAG</a> 
    uw.<a href="cpl.html#REAL">REAL</a>=u.<a href="cpl.html#REAL">REAL</a>&lowast;w.<a href="cpl.html#REAL">REAL</a>; uw.<a href="complex.html#Top">IMAG</a>=u.<a href="complex.html#Top">IMAG</a>&lowast;w.<a href="complex.html#Top">IMAG</a> 
  <a href="cpl.html#FOR">FOR</a> <a href="cpl.html#ALL">ALL</a> ix,iz
  <a href="cpl.html#DO">DO</a> <a href="cpl.html#WITH">WITH</a> VVd(&lowast;,iz): HFT(uu); HFT(uv); HFT(vv); HFT(vw); HFT(ww); HFT(uw) <a href="cpl.html#FOR">FOR</a> <a href="cpl.html#ALL">ALL</a> iz
  <a href="cpl.html#LOOP">LOOP</a> <a href="cpl.html#FOR">FOR</a> ix=0 <a href="cpl.html#TO">TO</a> nx
    <a href="cpl.html#WITH">WITH</a> VVd(ix,&lowast;): FFT(uu); FFT(uv); FFT(vv); FFT(vw); FFT(ww); FFT(uw)
    <a href="cpl.html#DO">DO</a> VVplane(ix,iz)=VVd(ix,iz) <a href="cpl.html#FOR">FOR</a> iz=0 <a href="cpl.html#TO">TO</a> nz
    <a href="cpl.html#DO">DO</a> VVplane(ix,iz)=VVd(ix,nzd+iz) <a href="cpl.html#FOR">FOR</a> iz=-nz <a href="cpl.html#TO">TO</a> -1
  <a href="cpl.html#LOOP">REPEAT</a> <a href="cpl.html#LOOP">LOOP</a>
<a href="cpl.html#END">END</a> convolutions
</pre></body></html>
